<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="JCDY">
      <select id="queryYPCYXE" parameterType="java.util.Map" resultType="java.util.Map">
  SELECT A.GSXX01,A.JLBH "jlbh",A.SPXX01,A.WLDW01 KHBM,9038 "bdbh", W.WLDW02 KHMC,S.SPXX02 SPBM, S.SPXX04 SPMC, CYXE, YCYSL
  	FROM YPCYXE A, SPXX S, WLDW W
		 WHERE A.SPXX01 = S.SPXX01
  		 AND A.WLDW01 = W.WLDW01
  		   JL{CZY|A.WLDW01|WLDW_CZ|inS}JL
      		JL{CZY|A.GSXX01|CZGS_CX|LIKE%}JL
      	<if test="GSXX != null and GSXX!=''">
           AND A.GSXX01=#{GSXX}
      </if>	
  		 <if test="KHXX != null and KHXX!=''">
           AND (A.WLDW01 LIKE '%'||#{KHXX}||'%' OR W.WLDW02 LIKE '%'||#{KHXX}||'%')
      </if>
       <if test="SPXX != null and SPXX!=''">
           AND (A.SPXX01 LIKE '%'||#{SPXX}||'%' OR S.SPXX02 LIKE '%'||#{SPXX}||'%')
      </if>
  </select>
  <!-- 查找在职的采购人员-->
   <select id="GZGW" parameterType="java.util.Map" resultType="java.util.Map">
   
	 SELECT A.GW01 ,A.GW02 ,A.GSXX01  FROM W_GW A 
      WHERE A.GW03=0
      <if test="GSXX01 != null and GSXX01!=''">
      AND A.GSXX01=#{GSXX01}
      </if>
      </select>
  <select id="RYGW" parameterType="java.util.Map" resultType="java.util.Map">
 <!--    SELECT A.CZY01,A.GW01,B.GW02 GWMC FROM W_CZYGW A,W_GW B 
	 --> 
	<!--   SELECT A.GW01 KEY,B.GW02 value FROM W_CZYGW A,W_GW B 
	 WHERE A.GW01 = B.GW01 
	   AND A.GSXX01 = B.GSXX01 
	   AND A.YXBJ = 0 
	   AND B.GW03 = 0
       <if test="GSXX01 != null and GSXX01 != ''">
       AND A.GSXX01 = #{GSXX01}
       </if>
       <if test="CZY01 != null and CZY01 != ''">
       AND A.CZY01 = #{CZY01}
       </if>
       <if test="CZYMC != null and CZYMC != ''">
       AND (A.CZY02 LIKE '%'||#{CZYMC}||'%' OR A.CZY01 LIKE '%'||#{CZYMC}||'%')
       </if>-->
        SELECT A.GW01 ,A.GW02 ,A.GSXX01  FROM W_GW A 
      WHERE A.GW03=0
      <if test="GSXX01 != null and GSXX01!=''">
      AND A.GSXX01=#{GSXX01}
      </if>
  </select>
  <!-- 仓库 -->
   <select id="CK" parameterType="java.util.Map" resultType="java.util.Map">
    SELECT A.CK01, A.CK02 
      FROM CK A, GSXX B
     WHERE A.GSXX01 = B.GSXX01
       <if test="GSXX01 != null and GSXX01 != ''">
       AND A.GSXX01 = #{GSXX01}
       </if>
       <if test="CK01 != null and CK01 != ''">
       AND A.CK01 = #{CK01}
       </if>
       <if test="CKMC != null and CKMC != ''">
       AND A.CK02 LIKE '%'||#{CKMC}||'%'
       </if>
       <if test="MJBJ != null">
       AND A.CK04 = #{MJBJ}
       </if>
       <if test="CKJB != null">
       AND A.CK03 = #{CKJB}
       </if>
       <if test="ZDCKBJ != null">
       AND A.CK05 = #{ZDCKBJ}
       </if>
       <if test="CJCKBJ != null">
       AND A.CK06 = #{CJCKBJ}
       </if>
       <if test="CKSX != null">
       AND A.CK09 = #{CKSX}
       </if>
       JL{CZY|A.CK01|CK_CZ|LIKE%}JL
       JL{CZY|A.GSXX01|CZGS_CZ|LIKE%}JL
  </select>
  <!-- 部门权限 -->
    <select id="BM" parameterType="java.util.Map" resultType="java.util.Map">
    SELECT A.BM01, A.BM02 
      FROM BM A, GSXX B
     WHERE A.GSXX01 = B.GSXX01
       <if test="GSXX01 != null and GSXX01 != ''">
       AND A.GSXX01 = #{GSXX01}
       </if>
       <if test="BM01 != null and BM01 != ''">
       AND A.BM01 = #{BMMC}
       </if>
       <if test="BMMC != null and BMMC != ''">
       AND A.BM02 LIKE '%'||#{BMMC}||'%'
       </if>
       <if test="MJBJ != null">
       AND A.BM04 = #{MJBJ}
       </if>
       <if test="BMSX != null">
       AND A.BM06 = #{BMSX}
       </if>
       JL{CZY|A.BM01|BM_CZ|LIKE%}JL
       JL{CZY|A.GSXX01|CZGS_CZ|LIKE%}JL
  </select>
  <!-- 品牌权限 -->
  <select id="SPPP" parameterType="java.util.Map" resultType="java.util.Map">
    SELECT A.PPB01 , A.PPB02 
      FROM PPB A
     WHERE 1=1
       <if test="SPPPMC != null and SPPPMC != ''">
        AND (A.PPB02 LIKE '%'||#{SPPPMC}||'%' OR   A.PPB01 LIKE '%'||#{SPPPMC}||'%')
       </if>
  </select>
  
  <select id="GZBM" parameterType="java.util.Map" resultType="java.util.Map">
    SELECT A.BM01 key , A.BM02 value,BM06
      FROM BM A, GSXX B
     WHERE A.GSXX01 = B.GSXX01
       <if test="GSXX01 != null and GSXX01 != ''">
       AND A.GSXX01 LIKE #{GSXX01}||'%'
       </if>
       <if test="BM01 != null and BM01 != ''">
       AND A.BM01 = #{BM01}
       </if>
       <if test="BMMC != null and BMMC != ''">
       AND A.BM02 LIKE '%'||#{BMMC}||'%'
       </if>
       <if test="MJBJ != null">
       AND A.BM04 = #{MJBJ}
       </if>
       <if test="BMSX != null">
       AND A.BM06 = #{BMSX}
       </if> 
  </select>
  
 	<select id="GSXX" parameterType="Map" resultType="java.util.Map">
		SELECT A.GSXX01 KEY,A.GSXX02 VALUE
		  FROM GSXX A
	     WHERE 1 = 1 
      		   <if test="GSXX01 != null">AND A.GSXX01 =  #{GSXX01}</if> 
      		   JL{CZY|A.GSXX01|CZGS_CZ|inS}JL
	</select>
 	
 	<select id="JTXX" parameterType="Map" resultType="java.util.Map">
		 SELECT A.GSXX01 KEY,A.GSXX02 VALUE
		   FROM GSXX A
		  WHERE  1 = 1 
		  <if test="CZY14 != null"> 
	      		JL{CZY|A.GSXX01|CZGS_CZ|inS}JL
	      </if> 
	      <if test="GSXX01 != null">
	      		AND A.GSXX01 =  #{GSXX01}
	      </if> 
	</select>
	
	 <!-- 币种 -->
    <select id="BZ" parameterType="java.util.Map" resultType="java.util.Map">
    SELECT A.WBBZ01 key, A.WBBZ02 value
      FROM BZ  A
      </select>
       <!-- 帐套 --> 
    <select id="ZT" parameterType="java.util.Map" resultType="java.util.Map">
    SELECT GSXX01,WBZT01,WBZT02,NCGSID,NCGSPK,RYXX01,CWJK
      FROM WBZT
      WHERE 1=1
      <if test="GSXX01 != null">
	      AND GSXX01 =  #{GSXX01}
	   </if> 
     JL{CZY|GSXX01|CZGS_CZ|LIKE%}JL
      </select>
      
      <select id="GYSZHZ" parameterType="java.util.Map" resultType="java.util.Map">
    SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='00006'
      </select>
      <select id="KHZHZ" parameterType="java.util.Map" resultType="java.util.Map">
    SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='00007'
      </select>
      
      <select id="GJ" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='00011'
      </select>
      
      <select id="KHGLZ" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='00013'
      </select>
      
      <select id="GYSTYKM" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='00002' AND A.SJNRBM = 'K'
      </select>
      <select id="KHTYKM" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='00002' AND A.SJNRBM = 'D'
      </select>
      <select id="PXDM" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='00010'
      </select>
      <select id="XJGLZ" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='00009'
      </select>
      <select id="FKTJDM" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='00008'
      </select>
      <select id="CBZXLX" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='00003'
      </select>
      <select id="GNFW" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='00004'
      </select>
      <select id="CCJGFW" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='00005'
      </select>
		
		 <!-- 利润中心 --> 
	<select id="LRZX" parameterType="java.util.Map" resultType="java.util.Map">
    SELECT NRBM key,NRMS value
      FROM ZDYITEM 
      WHERE ID='00001'
      </select>
    <!-- 消息分类 --> 
	<select id="XXFL" parameterType="java.util.Map" resultType="java.util.Map">
   SELECT NRBM key,NRMS value FROM ZDYITEM WHERE ID = 'TZGG_XXFL'
      </select>
      
      <select id="BMKZ" parameterType="java.util.Map" resultType="java.util.Map">
   SELECT BM01 key,BM02 value FROM BM 
    WHERE BM04=1
       <if test="GSXX01 != null">
	      AND GSXX01 =  #{GSXX01}
	   </if>
  		<if test="BM01 != null and BM01 != ''">
       AND (BM01 LIKE '%'||#{BM01}||'%' OR BM02 LIKE '%'||#{BM01}||'%')
       </if>
       JL{CZY|GSXX01|CZGS_CZ|LIKE%}JL
      </select>
      
          <!-- 取费用部门--> 
	 <select id="FYBM" parameterType="java.util.Map" resultType="java.util.Map">
  		 SELECT FYBM01,FYBM02  FROM FYBM 
  		 WHERE FYBM03=1
  		 <if test="FYBM01 != null and FYBM01 != ''">
       		AND (FYBM01 = #{FYBM01} OR FYBM02 = #{FYBM01})
        </if>
         <if test="GSXX01 != null">
	      AND GSXX01 =  #{GSXX01}
	   </if>
         JL{CZY|GSXX01|CZGS_CZ|LIKE%}JL
      </select>

	   <select id="SX01" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='SPXX_YS'
      </select>
      
      <select id="SX02" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='SPXX_CC'
      </select>
      
      <select id="SX03" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='SPXX_FBL'
      </select>
      
      <select id="SX04" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='SPXX_XS'
      </select>
      
      <select id="SX05" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='SPXX_DCRL'
      </select>
      
      <select id="SX06" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='SPXX_CPU'
      </select>
      
      <select id="SX07" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='SPXX_JCNC'
      </select>
      
      <select id="SX08" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='SPXX_YYNC'
      </select>
      
      <select id="SX09" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='SPXX_DSK'
      </select>
      
      <select id="SX10" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.NRBM KEY,A.NRMS VALUE FROM ZDYITEM A
      WHERE A.ID='SPXX_TZNC'
      </select>
      
      <select id="updateRYDate" parameterType="java.util.Map" resultType="java.util.Map">
   		 SELECT   RYXX01  FROM  RYXX 
          WHERE 1=1
         <if test="GSXX01 != null">
	      AND GSXX01 =  #{GSXX01}
	  	 </if>
	   	<if test="RYXX01 != null and RYXX01 != ''">
	      AND RYXX01 =  #{RYXX01}
	   </if>
      </select>
      <!-- 查询CK保管帐数 -->
      <select id="BGZS" parameterType="java.util.Map" resultType="java.util.Map">
   		 SELECT   SUM(CKSP03) BGZS FROM  CKSP 
          WHERE  CK01 = #{CK01}
      </select>
      <select id="XH" parameterType="java.util.Map" resultType="java.util.Map">
   		SELECT COUNT(0) TS FROM JXCKMDY
   		WHERE WBZT01=#{WBZT01}
   		AND   PZLX01=#{PZLX01}
      </select>
      
      <select id="CXKHWLDW" parameterType="java.util.Map" resultType="java.util.Map">
     SELECT A.WLDW01 KEY,A.WLDW02 VALUE FROM WLDW A
      WHERE A.WLDW20='1' AND WLDW21='0'
      JL{CZY|A.WLDW01|WLDW_CZ|inS}JL
      <if test="WLDWMC != null and WLDWMC != ''">
       AND (WLDW01 LIKE '%'||#{WLDWMC}||'%' OR WLDW02 LIKE '%'||#{WLDWMC}||'%')
       </if>
      </select>
      
       <!-- 查询现金流量项目 -->
      <select id="XJLLXM" parameterType="java.util.Map" resultType="java.util.Map">
    	 SELECT  XJLL01 KEY,XJLL02 VALUE FROM XJLLXM
      </select>
</mapper>