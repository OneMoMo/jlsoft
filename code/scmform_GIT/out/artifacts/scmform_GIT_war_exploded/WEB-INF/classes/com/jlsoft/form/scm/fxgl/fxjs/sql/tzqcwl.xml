<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="TZQCWL">
<!-- 调整期初往来 -->
  	<select id="KHWL" parameterType="java.util.Map" resultType="java.util.Map">
		SELECT 
		B.WLDW02  WLDWMC,
		C.BM02 BMMC,
		A.DWYE05 XYEE,
		A.DWYE04 YSYE,
		A.DWYE01 HKYE,
		A.DWYE13 YUSYE,
		A.DWYE07 FPYE,
		A.DWYE03 YFYE,
		A.DWYE06 FLYE
		FROM DWYEZ A, WLDW B,BM C
		WHERE A.WLDW01 = B.WLDW01
		AND A.BM01=C.BM01
		AND B.WLDW20=1
		
		<if test="GSXX01 != null and GSXX01 !='' ">
			AND A.GSXX01 = #{GSXX01}
		</if>
		<if test="KH01 != null and KH01 !='' ">
			AND A.WLDW01=#{KH01}
		</if>
	<if test="XSBMMC != null and XSBMMC != ''">
			AND A.BM01=#{XSBMMC}
		</if>
	</select>
	<select id="GYSWL" parameterType="java.util.Map" resultType="java.util.Map">
		SELECT 
		B.WLDW02  WLDWMC,
		C.BM02 BMMC,
		A.DWYE01 HKYE,
		A.DWYE02 YFKYE,
		A.DWYE07 FPYE
		FROM DWYEZ A, WLDW B,BM C
		WHERE A.WLDW01 = B.WLDW01
		AND A.BM01=C.BM01
		AND B.WLDW20=0
		<if test="GSXX01 != null and GSXX01 !='' ">
			AND A.GSXX01 = #{GSXX01}
		</if>
		<if test="GYS01 != null and GYS01 !='' ">
			AND A.WLDW01=#{GYS01}
		</if>
	<if test="CGBMMC != null and CGBMMC != ''">
			AND A.BM01=#{CGBMMC}
		</if>
	</select>
	</mapper>
