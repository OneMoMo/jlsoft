<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ORACLE_GCDLD">
	<select id="SCM_CXGCDLDEJ" parameterType="Map" resultType="java.util.Map">
	select  GCDLD01, 
     SPDM,
      SPMC,
       PFSL,
      GCZZSL,
      YHSL,
       YSZZSL,
       THSL,
       ZLSL,
       JCSL,
     BZJYE,
       BZJSQJE,
       BZJTHJE from (
		select A.GCDLD01,A.GCSPBM SPDM,A.GCSPMC SPMC,A.PFSL,A.GCZZSL,A.YHSL,A.YSZZSL,A.THSL,A.ZLSL,A.JCSL
		,(A.BZJSQJE - A.BZJTHJE)BZJYE,A.BZJSQJE,A.BZJTHJE
       from GCDLD A
        WHERE 1=1
		<if test="GCDLD01 != null and GCDLD01 != ''">
			AND A.GCDLD01=#{GCDLD01}
	    </if>
		<if test="GSXX01 != null and GSXX01 != ''">
			AND A.GSXX01=#{GSXX01}
	    </if>
	     JL{CZY|A.WLDW01|WLDW_CZ|inS}JL
	     JL{CZY|A.GSXX01|CZGS_CZ|LIKE%}JL
	    )where 1= 1
	   <if test="SPMC != null and SPMC != ''">
            AND SPDM LIKE '%'||#{SPMC}||'%' OR SPMC LIKE '%'||#{SPMC}||'%' 
       </if>
	</select>
</mapper>