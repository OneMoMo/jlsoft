<script type="text/javascript">
/* 打印赠品出库单 */
var DYZPCKD = function(data){
	debugger;
	var ZPMXLB=data.ZPMXLB;
	var DYTS=0,height=0;
	var LODOP = getLodop();
	LODOP.NewPage();
	LODOP.PRINT_INITA(0,0,794,559,"赠品出库单");
	LODOP.SET_PRINT_PAGESIZE(0,2100,1400,"");
	LODOP.ADD_PRINT_HTM(0,0,"99%","99%","");
	DYZPCKD.getTitle(data,LODOP);

	for(var i=0;i<ZPMXLB.length;i++){
		DYTS++;
		if(i%8==0 && i!=0){
			DYZPCKD.getButtom(data, LODOP ,(height+125));
			LODOP.NewPageA();
			DYZPCKD.getTitle(data,LODOP);
			DYTS=1;
		}
		height=25*DYTS;
		var ZPMC=JL.isNull(ZPMXLB[i].ZPMC)?"": ZPMXLB[i].ZPMC;
		var ZPXX01=JL.isNull( ZPMXLB[i].ZPXX01)?"": ZPMXLB[i].ZPXX01;
		var KCKSL=JL.isNull( ZPMXLB[i].KCKSL)?"": ZPMXLB[i].KCKSL;
		var ZPMC=JL.isNull( ZPMXLB[i].ZPMC)?"": ZPMXLB[i].ZPMC;
		LODOP.ADD_PRINT_TEXT(140+height,210,200,20,ZPMC);
		LODOP.SET_PRINT_STYLEA(0,"FontSize",10);
		LODOP.SET_PRINT_STYLEA(0,"Alignment",1);
		LODOP.ADD_PRINT_TEXT(140+height,30,100,20,ZPXX01);
		LODOP.SET_PRINT_STYLEA(0,"FontSize",10);
		LODOP.SET_PRINT_STYLEA(0,"Alignment",1);
		LODOP.ADD_PRINT_TEXT(140+height,450,100,20,KCKSL);
		LODOP.SET_PRINT_STYLEA(0,"FontSize",10);
		LODOP.SET_PRINT_STYLEA(0,"Alignment",1);
		LODOP.ADD_PRINT_TEXT(140+height,560,100,20,"");
	}
	DYZPCKD.getButtom(data, LODOP,(height+150));
	LODOP.SET_PRINT_STYLEA(1,"Stretch",1);
	LODOP.NewPageA(); 
	LODOP.PREVIEW();
	window.close();
};
DYZPCKD.getTitle=function(data,LODOP){
	LODOP.ADD_PRINT_TEXT(140,30,100,20,"赠品代码：");
	LODOP.ADD_PRINT_TEXT(110,30,100,20,"部门名称;");
	LODOP.ADD_PRINT_TEXT(80,30,100,20,"仓库名称：");
	LODOP.ADD_PRINT_TEXT(54,300,100,20,"赠品出库单");
	LODOP.SET_PRINT_STYLEA(0,"FontSize",12);
	LODOP.SET_PRINT_STYLEA(0,"Bold",1);
	LODOP.ADD_PRINT_TEXT(22,273,261,25,"上海束氏有限公司");
	LODOP.SET_PRINT_STYLEA(0,"FontSize",15);
	LODOP.SET_PRINT_STYLEA(0,"Bold",1);
	LODOP.ADD_PRINT_TEXT(140,210,100,20,"赠品名称");
	LODOP.ADD_PRINT_TEXT(140,450,100,20,"出货数量");
	LODOP.ADD_PRINT_TEXT(140,560,100,20,"单位");
	LODOP.ADD_PRINT_TEXT(110,350,100,20,"收获单位:()");
	LODOP.ADD_PRINT_TEXT(80,450,100,20,"赠品出货单号：");
	LODOP.SET_PRINT_STYLEA(0,"Bold",1);
	LODOP.ADD_PRINT_TEXT(51,549,100,20,"打印时间：");
	LODOP.ADD_PRINT_TEXT(25,562,22,20,"第");
	LODOP.ADD_PRINT_TEXT(25,587,14,20,"");
	LODOP.SET_PRINT_STYLEA(0,"ItemType",2);
	LODOP.ADD_PRINT_TEXT(25,606,18,20,"页");
	LODOP.ADD_PRINT_TEXT(25,632,17,20,"/");
	LODOP.ADD_PRINT_TEXT(25,656,18,20,"共");
	LODOP.ADD_PRINT_TEXT(25,678,15,20,"");
	LODOP.SET_PRINT_STYLEA(0,"ItemType",3);
	LODOP.ADD_PRINT_TEXT(25,696,19,20,"页");
	//划线
	 LODOP.ADD_PRINT_LINE(138,30, 138, 750,0, 1);
	 LODOP.ADD_PRINT_LINE(162,30, 162, 750,0, 1);
	 LODOP.ADD_PRINT_IMAGE(10,30,180,60,  "<img width='180px' height='60px' src='scm/zpgl/zpck/logo01.jpg' />");
};
DYZPCKD.getButtom=function(data,LODOP,height){
	LODOP.ADD_PRINT_TEXT(500,30,100,20,"备注：");
	LODOP.ADD_PRINT_TEXT(500,600,100,20,"签字：");
	LODOP.SET_PRINT_STYLEA(0,"Bold",1);
	LODOP.ADD_PRINT_TEXT(470,30,100,20,"录入日期：");
	LODOP.ADD_PRINT_TEXT(470,250,100,20,"审核日期：");
	LODOP.ADD_PRINT_TEXT(440,30,100,20,"制单人：");
	LODOP.ADD_PRINT_TEXT(440,250,100,20,"审核人：");
	LODOP.ADD_PRINT_TEXT(400,50,100,20,"合计");
	//划线   
	LODOP.ADD_PRINT_LINE(398,30, 398, 750,0, 1);
	LODOP.ADD_PRINT_LINE(421,30, 421, 750,0, 1);
};
</script>